**Query:** Fetch all the order items that are in the created status and the order type should be a sales order

- ORDER_ID
- PRODUCT_TYPE_ID
- ORDER_LINE_ID
- EXTERNAL_ID
- SALES_CHANNEL
- QUANTITY
- ITEM_STATUS 
- PRODUCT_ID
- BILL_CITY
- BILL_COUNTRY
- BILL_POSTALCODE
- BILL_ADDRESS1
- BILL_ADDRESS2
- SHIP_CITY
- SHIP_COUNTRY
- SHIP_POSTALCODE
- SHIP_ADDRESS1
- SHIP_ADDRESS2

**Query cost**: 173881.28

```sql
select
	oh.ORDER_ID ORDER_ID,
	p.PRODUCT_TYPE_ID PRODUCT_TYPE_ID,
	oi.EXTERNAL_ID ITEM_EXTERNAL_ID,
	oh.SALES_CHANNEL_ENUM_ID SALES_CHANNEL,
	oi.QUANTITY,
	oi.STATUS_ID ITEM_STATUS,
	oi.PRODUCT_ID,
	pa1.CITY BILL_CITY,
	pa1.COUNTRY_GEO_ID BILL_COUNTRY,
	pa1.POSTAL_CODE BILL_POSTALCODE,
	pa1.ADDRESS1 BILL_ADDRESS1,
	pa1.ADDRESS2 BILL_ADDRESS2,
	pa2.CITY SHIP_CITY,
	pa2.COUNTRY_GEO_ID SHIP_COUNTRY,
	pa2.POSTAL_CODE SHIP_POSTALCODE,
	pa2.ADDRESS1 SHIP_ADDRESS1,
	pa2.ADDRESS2 SHIP_ADDRESS2
from order_header oh
join order_item oi
on
	oi.ORDER_ID = oh.ORDER_ID
	and oh.ORDER_TYPE_ID = "SALES_ORDER"
	and oi.STATUS_ID = "ITEM_CREATED"
join order_contact_mech ocm
on
	ocm.ORDER_ID = oi.ORDER_ID
	and ocm.CONTACT_MECH_PURPOSE_TYPE_ID in ("BILLING_LOCATION", "SHIPPING_LOCATION")
left join postal_address pa1
	on pa1.CONTACT_MECH_ID = ocm.CONTACT_MECH_ID
	and ocm.CONTACT_MECH_PURPOSE_TYPE_ID = "BILLING_LOCATION"
left join postal_address pa2
	on pa2.CONTACT_MECH_ID = ocm.CONTACT_MECH_ID
	and ocm.CONTACT_MECH_PURPOSE_TYPE_ID = "SHIPPING_LOCATION"
join product p
	on p.PRODUCT_ID = oi.PRODUCT_ID
;
```
